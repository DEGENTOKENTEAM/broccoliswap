import Head from 'next/head'
import { Allotment, LayoutPriority } from "allotment";
import { Navbar } from '@/components/Navbar'
import { BottomBar } from '@/components/BottomBar'
import { Chart } from '@/components/Chart'
import { TokenHeader } from '@/components/TokenHeader';
import { TokenInfoTable } from '@/components/TokenInfoTable';
import { Swap } from '@/components/Swap';
import { useEffect, useState } from 'react';
import { Token } from '@/types';

import "allotment/dist/style.css";
import NonSSR from '@/components/NonSSR';

const Main = () => {
  const [activeToken, setActiveToken] = useState<Token>({
    // network: 'avalanche',
    // address: '0x51e48670098173025c477d9aa3f0eff7bf9f7812',
    // coingeckoId: 'degenx',
    // name: 'DegenX',
    // symbol: 'DGNX'

    network: 'avalanche',
    address: '0xb31f66aa3c1e785363f0875a1b74e27b85fd66c7',
    coingeckoId: 'avalanche-2',
    name: 'Avalanche',
    symbol: 'AVAX'
  })

  console.log('active', activeToken)

  return (
    <main className="min-h-screen grid grid-rows-[min-content_1fr_min-content]">
      <Navbar setActiveToken={setActiveToken} />

      <Allotment>
        <Allotment.Pane preferredSize="75%">
          <Allotment vertical>
            <Allotment.Pane preferredSize={80} minSize={80}>
              <TokenHeader token={activeToken} />
            </Allotment.Pane>
            <Allotment.Pane preferredSize="50%">
              <Chart token={activeToken} />
            </Allotment.Pane>
            <Allotment.Pane preferredSize="50%">
              <TokenInfoTable token={activeToken} />
            </Allotment.Pane>
          </Allotment>
        </Allotment.Pane>
        <Allotment.Pane>
          <Swap />
        </Allotment.Pane>
      </Allotment>

      <BottomBar />
    </main>
  )
}

export default function Home() {
  

  const [ready, setReady] = useState(false)

  useEffect(() => setReady(true), [])

  if (!ready) {
    return null;
  }

  return (
    <>
      <Head>
        <title>Broccoliswap</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/logo.png" />
      </Head>
      <NonSSR>
        <Main />
      </NonSSR>
    </>
  )
}
